/* Machine Crafted with Care (tm) by slaxWriter */
version 1.1;

param $name = "Poe";
var $favorites := {
    <name hidden="yes"> "Spillane";
    <name> "Doyle";
}

match / {
    <out> {
        /* Parameters are passed by name */
        call test($elt = "author", $name);
    }
}

template test ($name, $elt = "default") {
    for $this ($favorites/name) {
        if ($name == $this && not(@hidden)) {
            element $elt {
                copy-of .//author[name/last == $this];
            }
        
        } else if ($name == .) {
            message "Hidden: " _ $name;
        }
    }
    
}
